<!DOCTYPE html>
{% load static %}
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parolni o'zgartirish â€¢ {{ request.user.username }}</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        /* Xatolik xabarlari uchun stil */
        .error-list {
            list-style: none;
            padding: 0;
            margin: 5px 0 0;
        }
        .error-item {
            color: #ff453a;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }
    </style>
</head>
<body class="bg-alt">

<header class="header" id="header">
    <div class="container header__inner">
        <a href="/" class="logo">{{ home.logo }}<span class="logo__dot">.</span></a>
        <div class="header__actions">
            <button class="theme-toggle" id="theme-button">
                <svg class="theme-icon sun" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                </svg>
                <svg class="theme-icon moon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                </svg>
            </button>
        </div>
    </div>
</header>

<main class="main-content">
    <section class="section">
        <div class="container">
            <div class="profile-card glass-card" style="max-width: 400px; margin: 60px auto 0;">

                <div class="profile-avatar-container">
                    <img src="{% if user.profile.avatar %}{{ user.profile.avatar.url }}{% else %}{% static 'img/default-avatar.jpg' %}{% endif %}"
                         alt="Avatar" class="profile-img">
                </div>

                <h2 style="margin-bottom: 0.5rem; color: var(--text-main); text-align: center;">Xavfsizlik</h2>
                <p class="text-muted" style="text-align: center; margin-bottom: 2rem; font-size: 0.9rem;">Parolni yangilash</p>

                {% if form.non_field_errors %}
                    <div style="background: rgba(255, 69, 58, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 1rem;">
                        {% for error in form.non_field_errors %}
                            <p class="error-item" style="justify-content: center;"><i class='bx bx-error-circle'></i> {{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                <form method="POST" class="edit-form">
                    {% csrf_token %}

                    <div class="form__group">
                        <label>Eski parol</label>
                        <input type="password" name="old_password" class="form__input" placeholder="********" required>
                        {% if form.old_password.errors %}
                            <ul class="error-list">
                                {% for error in form.old_password.errors %}
                                    <li class="error-item"><i class='bx bx-error-circle'></i> {{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>

                    <div class="form__group">
                        <label>Yangi parol</label>
                        <input type="password" name="new_password1" class="form__input" placeholder="Yangi parol" required>
                        {% if form.new_password1.errors %}
                            <ul class="error-list">
                                {% for error in form.new_password1.errors %}
                                    <li class="error-item"><i class='bx bx-error-circle'></i> {{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>

                    <div class="form__group">
                        <label>Yangi parolni tasdiqlash</label>
                        <input type="password" name="new_password2" class="form__input" placeholder="Qayta kiriting" required>
                        {% if form.new_password2.errors %}
                            <ul class="error-list">
                                {% for error in form.new_password2.errors %}
                                    <li class="error-item"><i class='bx bx-error-circle'></i> {{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div>

                    <button type="submit" class="btn btn--primary btn--full" style="margin-top: 1rem;">
                        Parolni yangilash
                    </button>

                    <a href="/profile/" class="back-link"
                       style="display: block; text-align: center; margin-top: 1rem; color: var(--text-light); text-decoration: none; font-size: 0.9rem;">
                        Orqaga qaytish
                    </a>
                </form>
            </div>
        </div>
    </section>
</main>

<script src="{% static 'js/main.js' %}"></script>
</body>
</html>